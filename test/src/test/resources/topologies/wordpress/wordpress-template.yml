tosca_definitions_version: tosca_simple_yaml_1_0_0_wd03
description: TOSCA simple profile with a topology template for wordpress
template_name: wordpress-template
template_version: 1.1.0-SNAPSHOT
template_author: FastConnect

topology_template:
  description: Wordpress deployment template
  inputs:
    os_arch:
      type: string
      constraints:
        - valid_values: ["x86_32", "x86_64"]
      description: The host Operating System (OS) architecture.
    os_type:
      type: string
      constraints:
        - valid_values: ["linux", "aix", "mac os", "windows"]
      description: The host Operating System (OS) type.
    os_distribution:
      type: string
      required: false
      description: The host Operating System (OS) distribution.
    os_version:
      type: string
      required: false
      description: The host Operating System version.    
  node_templates:
    wordpress:
      type: alien.nodes.Wordpress
      requirements:
        - host: apache
        - database: 
            node: mysql
            capability: alien.capabilities.MysqlDatabase
        - php: 
            node: php
            capability: alien.capabilities.PHPModule
    php:
      type: alien.nodes.PHP
      requirements:
        - host: computeWww
    computeDb:
      type: com.mkv.tosca.docker.nodes.Container
      properties:
        image_id: tosca
        os_type: { get_input: os_type }
        os_distribution: { get_input: os_distribution }
        os_version: { get_input: os_version }
        os_arch: { get_input: os_arch }
        num_cpus: 1
        mem_size: 1024 MB
        disk_size: 1 GB
    computeWww:
      type: com.mkv.tosca.docker.nodes.Container
      properties:
        image_id: tosca
        exposed_ports: 80
        port_mappings: 80 - 51000
        os_type: { get_input: os_type }
        os_distribution: { get_input: os_distribution }
        os_version: { get_input: os_version }
        os_arch: { get_input: os_arch }
        num_cpus: 1
        mem_size: 1024 MB
        disk_size: 1 GB
    apache:
      type: alien.nodes.Apache
      properties:
        port: 80
        document_root: "/var/www"
      requirements:
        - host: computeWww
    mysql:
      type: alien.nodes.Mysql
      requirements:
        - host: computeDb
